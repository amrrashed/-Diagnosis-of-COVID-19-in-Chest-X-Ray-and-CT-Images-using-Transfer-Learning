clc
clf
clear all
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Data %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
x = [0.115449928468533;0.115449928468533;0.141983181538756;0.141983181538756;0.141983181538756;0.168499928603187;0.168499928603187;0.196190577784166;0.196190577784166;0.241565459297357;0.248613592364346;0.258841139359308;0.258841139359308;0.258841139359308;0.290633215657354;0.311617828322372;0.347245340154444;0.347245340154444;0.383334436087655;0.383334436087655;0.399456740799045];
y = [0.244362000000000;0.274341000000000;0.262127000000000;0.264126720454947;0.292321000000000;0.296719000000000;0.307925000000000;0.303586000000000;0.306481000000000;0.342394000000000;0.353323000000000;0.344114000000000;0.405466000000000;0.407161000000000;0.393931000000000;0.380215000000000;0.382303000000000;0.437020000000000;0.405000000000000;0.417000000000000;0.394165000000000];

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Prediction interval %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

fitresult = fit(x,y,'poly1');
p = predint(fitresult,x,0.95,'observation','off');


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% confidence interval %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

ci = confint(fitresult,0.95);
ciup = polyval( ci(2,:),x);
cilow = polyval(ci(1,:),x);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Plot %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
plot(fitresult,x,y),hold on,plot(x,p,'m--'),xlim([0.1 0.4]);
title('Prediction interval','Color','m');
hold on
plot(x,cilow,x,ciup,'Color','g');
legend('Data','Fitted curve','prediction interval','prediction interval','Confidence interval','Location','northwest');